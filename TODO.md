# 로또 관리 시스템 TODO 리스트

> 마지막 업데이트: 2025-10-04
> 현재 위치: 외부 (카페/공공장소)

---

## 🎯 오늘 완료한 작업

### 1. EC2 배포 및 마이그레이션 ✅
- [x] 데이터베이스 백업 생성
- [x] Purchase 모델 마이그레이션 실행
- [x] 복합 인덱스 추가
- [x] 마이그레이션 검증
- [x] EC2 서버 재시작

### 2. 전략분석 페이지 UX 개선 ✅
- [x] AJAX 기반 장바구니 추가 기능 구현
- [x] 우측 상단 장바구니 위젯 추가 (개수 배지)
- [x] 토스트 알림 시스템 구현 (성공/실패/경고)
- [x] 페이지 이동 없이 여러 세트 연속 선택 가능
- [x] 모바일 버전 동기화
- [x] API JSON 데이터 지원 추가 (`/api/purchases/add`)
- [x] JavaScript 문법 오류 수정 (next_round 기본값)
- [x] EC2 배포 및 정상 동작 확인

**관련 커밋**:
- `b2c577d` - AJAX 장바구니 추가 기능 구현
- `861a0f0` - strategy 페이지에 next_round 변수 추가
- `dbe4999` - JavaScript 문법 오류 수정
- `2dfa1b4` - API JSON 데이터 지원 추가

### 3. 대시보드 UI 개선 ✅
- [x] 다음 추첨 섹션 텍스트 가독성 향상
  - 흰색 글자에 강한 그림자 효과
  - label/value에 반투명 배경 추가
- [x] 요일 표시 영문→한글 변경 (Sat → 토)
- [x] 현재시간 실시간 표시 추가
- [x] 레이아웃 3열→4열 변경 (회차/추첨일시/현재시간/남은시간)
- [x] 최근 활동 섹션 제거 (페이지 간소화)

**관련 커밋**:
- `5baabf1` - 대시보드 다음 추첨 섹션 UI 개선
- `49eab52` - 대시보드 최근 활동 섹션 제거

---

## 📋 남은 작업 (우선순위 순)

### 🔴 긴급 (집에서 확인 필요)

#### 1. Python 환경 비교 및 QR 앱 호환성 문제 해결
**문제**:
- 집 Mac: QR 앱 정상 동작 (드래그 앤 드롭 포함)
- 외부 Mac: `RuntimeError: Unable to load tkdnd library.` 발생

**확인 사항**:
- [ ] Python 버전 비교
  ```bash
  # 집 Mac
  python --version

  # 외부 Mac
  python --version  # Python 3.13 확인됨
  ```
- [ ] tkinterdnd2 버전 비교
  ```bash
  pip show tkinterdnd2
  ```
- [ ] Tcl/Tk 버전 비교
  ```bash
  python -c "import tkinter; print(tkinter.TkVersion)"
  ```
- [ ] 가상환경 Python 버전 확인

**해결 방안 후보**:
1. Python 3.12로 가상환경 재생성 (집 환경과 동일하게)
2. Python 버전별 조건부 처리 추가
3. tkinterdnd2 업데이트 또는 재설치

---

### 🟡 중요 (다음 작업 세션)

#### 2. 웹 앱 추가 기능 테스트
- [ ] 전략분석 페이지 추가 테스트
  - [ ] 5개 추천 세트 모두 장바구니 추가 테스트
  - [ ] 중복 번호 추가 시 에러 메시지 확인
  - [ ] 장바구니 위젯 클릭 시 이동 확인
- [ ] 구매관리 페이지 테스트
  - [ ] 장바구니 목록 정상 표시 확인
  - [ ] 개별 삭제 기능 확인
  - [ ] 구매 확정 기능 확인
- [ ] 모바일 버전 테스트
  - [ ] 전략분석 페이지 AJAX 장바구니 기능
  - [ ] 토스트 알림 표시 확인
  - [ ] 장바구니 위젯 표시 확인

#### 3. 대시보드 추가 개선 (사용자 피드백 기반)
- [ ] 반응형 레이아웃 확인 (4열 → 모바일에서 적절히 조정)
- [ ] 현재시간 타임존 확인
- [ ] 카운트다운 정확도 검증

---

### 🟢 일반 (IMPROVEMENT_PLAN.md 참조)

#### Phase 3 남은 작업

**3.3 성능 최적화**
- [ ] N+1 쿼리 문제 해결
- [ ] Eager loading 적용
- [ ] 페이지네이션 개선
- [ ] 프론트엔드 최적화
  - [ ] JavaScript 번들 최소화
  - [ ] CSS 인라인화
  - [ ] 이미지 lazy loading

**3.1 웹 QR 스캔 통합** (선택 사항)
- [ ] 카메라 액세스 구현
- [ ] QR 코드 스캔 (jsQR 또는 ZXing)
- [ ] 스캔 결과 파싱
- [ ] UI/UX 구현

---

### 🔵 QR 앱 개선 (QR_APP_IMPROVEMENT_PLAN.md 참조)

#### Phase 3 남은 작업

**3.3 다크 모드** (선택 사항)
- [ ] 시스템 테마 감지
- [ ] 라이트/다크 테마 정의
- [ ] 테마 전환 버튼
- [ ] 설정에 테마 저장

**3.4 멀티스레딩 최적화** (부분 완료)
- [ ] ThreadPoolExecutor 통합
- [ ] 일괄 처리 병렬화 개선
- [ ] 진행률 스레드 안전성 확보
- [ ] 취소 버튼 구현
- [ ] 메모리 누수 점검

---

## 🚀 배포 전 체크리스트 (DEPLOYMENT_CHECKLIST.md 참조)

### 필수 항목
- [x] 데이터베이스 마이그레이션 완료
- [x] 환경 변수 확인 (EC2)
- [ ] 보안 체크
  - [x] CSRF 보호
  - [x] 비밀번호 보안
  - [x] 계정 잠금
  - [ ] SECRET_KEY 프로덕션 환경 설정
- [ ] 성능 테스트
  - [ ] 부하 테스트 (동시 접속 10명 이상)
  - [ ] 데이터베이스 최적화 확인
  - [ ] 페이지 로딩 속도 측정
- [ ] 백업 전략 수립
  - [ ] 데이터베이스 일일 백업 cron job
  - [ ] 백업 복구 테스트

---

## 📝 메모

### 현재 환경
- **위치**: 외부 (카페/공공장소)
- **서버**: EC2 (43.201.26.3:8080)
- **로컬 Python**: 3.13
- **이슈**: QR 앱 tkinterdnd2 호환성 문제

### 집 환경 (정상 동작)
- **Python 버전**: (확인 필요)
- **tkinterdnd2**: 정상 동작
- **드래그 앤 드롭**: 사용 가능

### 최근 커밋 (미푸시)
```
49eab52 대시보드 최근 활동 섹션 제거
5baabf1 대시보드 다음 추첨 섹션 UI 개선
2dfa1b4 Fix: /api/purchases/add API JSON 데이터 지원 추가
dbe4999 Fix: JavaScript 문법 오류 수정 (next_round 기본값 설정)
861a0f0 Fix: strategy 페이지에 next_round 변수 추가
b2c577d 전략분석 페이지 UX 개선: AJAX 장바구니 추가 기능 구현
```

**배포 명령어**:
```bash
# 로컬
git push origin main

# EC2
cd /home/ubuntu/lotto_manager_web
git pull origin main
./start.sh stop
./start.sh bg
```

---

## 🎯 다음 세션 계획

1. **집에서**:
   - Python 환경 비교
   - QR 앱 호환성 문제 해결
   - 미푸시 커밋 푸시 및 EC2 배포

2. **추가 테스트**:
   - 전체 기능 통합 테스트
   - 모바일 실기기 테스트
   - 성능 측정

3. **다음 개선 작업**:
   - Phase 3 나머지 작업 진행
   - 사용자 피드백 수집 및 반영
