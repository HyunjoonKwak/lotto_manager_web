{% extends "base.html" %}

{% block content %}
<div class="header">
  <div>
    <h1>ğŸ¯ {{ draw.round }}íšŒ ë‹¹ì²¨ì •ë³´</h1>
    <div class="muted">{{ draw.draw_date if draw.draw_date else 'ì¶”ì²¨ì¼ ë¯¸ìƒ' }}</div>
  </div>
  <div class="stats">
    <a href="{{ url_for('main.info_page') }}" class="btn-secondary">â† ì •ë³´ì¡°íšŒ</a>
  </div>
</div>

<div class="main-content">

  <!-- Draw Result Card -->
  <section class="card highlight-card">
    <div class="card-header">
      <h2>ğŸ² {{ draw.round }}íšŒ ë‹¹ì²¨ë²ˆí˜¸</h2>
      <span class="draw-date">{{ draw.draw_date if draw.draw_date else '' }}</span>
    </div>
    <div class="draw-result">
      <div class="numbers">
        {% for num in draw.numbers_list() %}
          <span class="number-ball">{{ num }}</span>
        {% endfor %}
      </div>
      <div class="bonus-section">
        <span class="plus">+</span>
        <span class="bonus-ball">{{ draw.bonus }}</span>
        <span class="bonus-label">ë³´ë„ˆìŠ¤</span>
      </div>
    </div>
  </section>

  <!-- Navigation -->
  <section class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 0;">
      <div style="display: flex; align-items: center; gap: 1rem;">
        {% if draw.round > 1 %}
          <a href="{{ url_for('main.draw_info') }}?round={{ draw.round - 1 }}" class="btn-secondary">
            â† {{ draw.round - 1 }}íšŒ
          </a>
        {% endif %}
        <div style="font-size: 1.2rem; font-weight: bold; color: #667eea; padding: 0 1rem;">
          {{ draw.round }}íšŒ
        </div>
        <a href="{{ url_for('main.draw_info') }}?round={{ draw.round + 1 }}" class="btn-secondary">
          {{ draw.round + 1 }}íšŒ â†’
        </a>
      </div>

      <form method="get" action="{{ url_for('main.draw_info') }}" style="display: flex; gap: 0.5rem; align-items: center;">
        <input type="number" name="round" min="1" max="9999" value="{{ draw.round }}" placeholder="íšŒì°¨" style="width: 80px; padding: 0.5rem; border: 1px solid #ddd; border-radius: 0.25rem;" />
        <button type="submit" class="btn-accent">ì´ë™</button>
      </form>
    </div>
  </section>

  <!-- Number Analysis -->
  <section class="card">
    <div class="card-header">
      <h2>ğŸ“Š ë²ˆí˜¸ ë¶„ì„</h2>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
      <div>
        <h3 style="margin-bottom: 1rem; color: #333;">í™€/ì§ ë¶„í¬</h3>
        {% set numbers = draw.numbers_list() %}
        {% set odd_numbers = [] %}
        {% set even_numbers = [] %}
        {% for num in numbers %}
          {% if num % 2 == 1 %}{% set _ = odd_numbers.append(num) %}
          {% else %}{% set _ = even_numbers.append(num) %}
          {% endif %}
        {% endfor %}
        <div style="display: flex; flex-direction: column; gap: 1rem;">
          <div style="display: flex; align-items: center; gap: 1rem;">
            <span style="min-width: 40px; font-weight: 500;">í™€ìˆ˜:</span>
            <span style="min-width: 30px; font-size: 0.9rem; color: #666;">{{ odd_numbers | length }}ê°œ</span>
            <span style="display: flex; gap: 0.25rem;">
              {% for num in odd_numbers %}
                <span style="display: inline-block; width: 24px; height: 24px; border-radius: 50%; color: white; font-size: 0.7rem; font-weight: bold; text-align: center; line-height: 24px; background: #e74c3c;">{{ num }}</span>
              {% endfor %}
            </span>
          </div>
          <div style="display: flex; align-items: center; gap: 1rem;">
            <span style="min-width: 40px; font-weight: 500;">ì§ìˆ˜:</span>
            <span style="min-width: 30px; font-size: 0.9rem; color: #666;">{{ even_numbers | length }}ê°œ</span>
            <span style="display: flex; gap: 0.25rem;">
              {% for num in even_numbers %}
                <span style="display: inline-block; width: 24px; height: 24px; border-radius: 50%; color: white; font-size: 0.7rem; font-weight: bold; text-align: center; line-height: 24px; background: #3498db;">{{ num }}</span>
              {% endfor %}
            </span>
          </div>
        </div>
      </div>

      <div>
        <h3 style="margin-bottom: 1rem; color: #333;">ì„¸ë¶€ ì •ë³´</h3>
        <div style="display: grid; gap: 0.5rem;">
          <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8f9fa; border-radius: 0.25rem;">
            <span style="font-weight: 500; color: #666;">í•©ê³„:</span>
            <span style="font-weight: bold; color: #333;">{{ numbers | sum }}</span>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8f9fa; border-radius: 0.25rem;">
            <span style="font-weight: 500; color: #666;">í‰ê· :</span>
            <span style="font-weight: bold; color: #333;">{{ "%.1f" | format(numbers | sum / 6) }}</span>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8f9fa; border-radius: 0.25rem;">
            <span style="font-weight: 500; color: #666;">ë²”ìœ„:</span>
            <span style="font-weight: bold; color: #333;">{{ numbers | min }} ~ {{ numbers | max }}</span>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8f9fa; border-radius: 0.25rem;">
            <span style="font-weight: 500; color: #666;">ë³´ë„ˆìŠ¤:</span>
            <span style="font-weight: bold; color: #333;">{{ draw.bonus }}</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick Actions -->
  <section class="card">
    <div class="card-header">
      <h2>âš¡ ë¹ ë¥¸ ì‘ì—…</h2>
    </div>
    <div class="action-groups">
      <div class="action-group">
        <h3>ğŸª ë‹¹ì²¨ì í¬ ë³´ê¸°</h3>
        <div class="button-row">
          <form class="action-form" method="get" action="/">
            <input type="hidden" name="shops_round" value="{{ draw.round }}" />
            <button type="submit" class="btn-accent">{{ draw.round }}íšŒ ë‹¹ì²¨ì í¬ ë³´ê¸°</button>
          </form>
        </div>
      </div>
    </div>
  </section>

</div>
{% endblock %}
